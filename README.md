花几天时间赶的web课程的实验： 仿写学校统一身份认证平台

## 要求

- 仿写学校统一身份认证平台
- 0框架
- 邮件或短信登录及认证
- 登录成功页面

## 实现

1. **wasm**（/static/wasm）

   rust实现简易加密，编译成wasm导出给js使用（前端需要加密传输，js原生无哈希函数，同时自己不想附带任何库）

   加密思路很普通，可以自行换用更复杂的方法

2. **自封装jQuery**（/static/js/ጿኈቼዽጿኈ.js）

3. **数据响应式封装**（/static/js/vu3.js）

4. **后端PHP**——0框架下能想到的最方便的了

   **RESTful规范**和**前后端分离MVC**的混杂体（

   **api.php**：api入口文件，根据参数调用controller.php处理相关事务,controller根据事务需要调用model.php执行数据库查询，并返回数据

   **index.php、success.php等**：普通视图文件。

## 安全

1. **sql安全**

   sql语句参数化、预编译

2. **事务安全**

   用户组——权限隔离

   修改密码：随机6位code，code相符的用户可获得修改密码权限

## 功能

**1.** **首页**

**I18n:** **中英文切换（数据动态响应**

**账号登录：密码加密，7天免登录**

**状态码登录：图片验证码、短信验证码**

**忘记密码：跳转忘记密码页面**

**账号注册：跳转账号注册页面**

**2. success页面**

**绑定邮箱（左下角）：由于注册时只保存UID、PASS、KEY，所以新用户需要绑定邮箱。跳转绑定邮箱界面。**

**修改密码（右下角）：跳转修改密码页面。**

**admin:** **所有用户表，可以编辑数据，删除用户（采用事件委托机制，避免对每个按钮绑定事件）。可以根据UID、mail、role检索用户，深色highlight（检索使用了防抖操作，保证实时显示同时保证性能）。**

**user:** **仅有欢迎字样**

**3.** **密码重置**

**需要6位code，对应登录用户访问时会自动生成，对应忘记密码用户重置时会发给用户邮箱（URL）。**

**4.** **绑定邮箱**

**和主页面功能很像，必须已登录。**

**5.** **注册**

**6.** **忘记密码**

##  ✨What you can do continuely

- **xss defence**

  检查时发现明显的xss漏洞(图方便，用的innerHTML😅)

  **defence**:

  - common: **CSP**、**http-only**、**waf**
  - fundamental: js动态创建标签，内容使用**innerTEXT**

- **权限隔离**

  在api分发处简单添加所需验证即可